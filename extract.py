import json
import pandas as pd

JSON_INPUT_PATH = "CoderEval/CoderEval4Java.json"
CSV_OUTPUT_PATH = "CoderEval/CoderEval4Java_Raw_Filtered.csv"

EXCLUDED_IDS = {
    "6367667f1a6d9265ec017458", "6367667d1a6d9265ec0173ff", "636766821a6d9265ec0174d2",
    "636767431a6d9265ec017c8d", "6367667c1a6d9265ec0173f7", "6367667c1a6d9265ec0173fb",
    "6367667f1a6d9265ec01745c", "636766801a6d9265ec017477", "636766801a6d9265ec017482",
    "636766811a6d9265ec017496", "636766811a6d9265ec017499", "636766821a6d9265ec0174b3",
    "636766851a6d9265ec017515", "636766a81a6d9265ec01757b", "636766a81a6d9265ec017596",
    "636766ef1a6d9265ec01761a", "636766f81a6d9265ec017748", "636766f81a6d9265ec01774b",
    "636766fe1a6d9265ec017823", "636766fe1a6d9265ec017833", "636767001a6d9265ec01787e",
    "636767001a6d9265ec01787f", "636767071a6d9265ec017962", "636767461a6d9265ec017d17",
    "6367674b1a6d9265ec017dc0", "636767531a6d9265ec017ef1", "636767531a6d9265ec017efb",
    "6367675a1a6d9265ec018010", "636767601a6d9265ec0180fd", "636767611a6d9265ec018106",
    "636767641a6d9265ec01817d", "636767641a6d9265ec018190", "636767691a6d9265ec0181ae",
    "636767781a6d9265ec018238", "636767781a6d9265ec01823d", "636767781a6d9265ec01823e",
    "636767781a6d9265ec018242", "636767791a6d9265ec018257", "636767791a6d9265ec018263",
    "6367677e1a6d9265ec018314", "636767841a6d9265ec0183f2", "636767841a6d9265ec0183ff",
    "636767aa1a6d9265ec01865a", "636767ab1a6d9265ec01867b", "636767dc1a6d9265ec0186c6",
    "636767de1a6d9265ec018706", "636767de1a6d9265ec01871e", "636767de1a6d9265ec018726",
    "636767e11a6d9265ec018790"
}

with open(JSON_INPUT_PATH, "r", encoding="utf-8") as f:
    data = json.load(f)

records = data.get("RECORDS", data)

df = pd.DataFrame(records)[["_id", "name", "code", "docstring", "human_label"]]

df_filtered = df[~df["_id"].isin(EXCLUDED_IDS)]

df_filtered.to_csv(CSV_OUTPUT_PATH, index=False, encoding="utf-8")

print(f"Filtered CSV file created: {CSV_OUTPUT_PATH}")
